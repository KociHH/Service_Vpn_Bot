# Service Vpn Bot

## Основная информация
Этот бот автоматизирует покупку и продление VPN‑подписок: после оплаты пользователь добавляется в систему на выбранный срок, получает QR‑код и пошаговую инструкцию по подключению. В составе есть админ‑панель для мониторинга, проверок БД и служебных операций.

## Идея
Упростить онбординг в VPN до пары кликов: выбрать тариф, оплатить, получить QR‑код и инструкцию — без ручных настроек и переписки с поддержкой.

## Как это работает
1. Пользователь выбирает тариф в боте и оплачивает подписку (срок определен в системе).
2. После успешной оплаты бот формирует и отправляет QR‑код + инструкцию по подключению и установке.
3. Периодические задачи следят за статусами, сроками и уведомлениями.
4. Админ‑панель дает контроль над подписками, состоянием БД и сервисными проверками.

## Ключевые возможности
- Подписки на разные сроки с автопродлением/уведомлениями.
- Авто‑выдача QR‑кода и инструкции после оплаты.
- Удобная админ‑панель: мониторинг, проверки, служебные операции.
- Надежная обработка платежей и статусов.

## Технологии
| Библиотека/Технология | Реализация в проекте |
|-----------------------|----------------------------------------------------------|
| `aiogram`             | Создание Telegram-Bot |
| `FastAPI`             | Используется для создания вебхуков, обеспечивающих взаимодействие бота с Telegram API. |
| `Celery`              | Периодические задачи (продления, проверки, уведомления). |
| `kos_Htools`          | Упрощенная работа с `SqlAlchemy`|
| `SqlAlchemy`          | Используется через `kos_Htools` работая с Postgresql храня всю информацию о пользователях. |
| `YooKassa`            | Платежный шлюз для проверки и подтверждения оплаты. |

## Запуск.

### Подготовка (.env):

Использовать **broker:6379** (имя сервиса celery) для запуска локально.

```bash
CELERY_BROKER_URL=redis://broker:6379/0
CELERY_RESULT_BACKEND=redis://broker:6379/0
```

### Сборка:

```bash
docker compose build
```
### Запуск в фоне:

```bash
docker compose up -d
```

### Логи:

Бот:
```bash
docker compose logs -f bot
```

Celery сервисы:
```bash
docker compose logs -f celery_worker
```
```bash
docker compose logs -f celery_beat
```

## Статус проекта
Коммерческий продукт, активно развивается: регулярные обновления и вправки.